{"ast":null,"code":"import \"core-js/modules/web.dom-collections.iterator.js\";import _setTimeout from \"@babel/runtime-corejs3/core-js-stable/set-timeout\";import _bindInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/bind\";import _extends from \"@babel/runtime-corejs3/helpers/extends\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();function _EMOTION_STRINGIFIED_CSS_ERROR__() {return \"You have tried to stringify object returned from `css` function. It isn't supposed to be used directly (e.g. as value of the `className` prop), but rather handed to emotion so it can handle it (e.g. as value of `css` prop).\";}var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useState } from 'react';\nimport cx from 'classnames';\nimport { t } from '@superset-ui/core';\nimport Icon from 'src/components/Icon';\nimport { Tooltip } from 'src/common/components/Tooltip';\nimport copyTextToClipboard from 'src/utils/copy';\nimport withToasts from 'src/messageToasts/enhancers/withToasts';\nimport { useUrlShortener } from 'src/common/hooks/useUrlShortener';\nimport EmbedCodeButton from './EmbedCodeButton';\nimport ConnectedDisplayQueryButton from './DisplayQueryButton';\nimport { exportChart, getExploreLongUrl } from '../exploreUtils';import { jsx as ___EmotionJSX } from \"@emotion/core\";var _ref = process.env.NODE_ENV === \"production\" ? { name: \"ynuca5-ActionButton\", styles: \"&:focus, &:focus:active{outline:0;};label:ActionButton;\" } : { name: \"ynuca5-ActionButton\", styles: \"&:focus, &:focus:active{outline:0;};label:ActionButton;\", map: \"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9hcHAvc3VwZXJzZXQtZnJvbnRlbmQvc3JjL2V4cGxvcmUvY29tcG9uZW50cy9FeHBsb3JlQWN0aW9uQnV0dG9ucy50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBZ0NzQyIsImZpbGUiOiIvYXBwL3N1cGVyc2V0LWZyb250ZW5kL3NyYy9leHBsb3JlL2NvbXBvbmVudHMvRXhwbG9yZUFjdGlvbkJ1dHRvbnMudHN4Iiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBMaWNlbnNlZCB0byB0aGUgQXBhY2hlIFNvZnR3YXJlIEZvdW5kYXRpb24gKEFTRikgdW5kZXIgb25lXG4gKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGVcbiAqIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9uXG4gKiByZWdhcmRpbmcgY29weXJpZ2h0IG93bmVyc2hpcC4gIFRoZSBBU0YgbGljZW5zZXMgdGhpcyBmaWxlXG4gKiB0byB5b3UgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlXG4gKiBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2VcbiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZyxcbiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuXG4gKiBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxuICogS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlXG4gKiBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zXG4gKiB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuaW1wb3J0IFJlYWN0LCB7IHVzZVN0YXRlIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IGN4IGZyb20gJ2NsYXNzbmFtZXMnO1xuaW1wb3J0IHsgdCB9IGZyb20gJ0BzdXBlcnNldC11aS9jb3JlJztcbmltcG9ydCBJY29uIGZyb20gJ3NyYy9jb21wb25lbnRzL0ljb24nO1xuaW1wb3J0IHsgVG9vbHRpcCB9IGZyb20gJ3NyYy9jb21tb24vY29tcG9uZW50cy9Ub29sdGlwJztcbmltcG9ydCBjb3B5VGV4dFRvQ2xpcGJvYXJkIGZyb20gJ3NyYy91dGlscy9jb3B5JztcbmltcG9ydCB3aXRoVG9hc3RzIGZyb20gJ3NyYy9tZXNzYWdlVG9hc3RzL2VuaGFuY2Vycy93aXRoVG9hc3RzJztcbmltcG9ydCB7IHVzZVVybFNob3J0ZW5lciB9IGZyb20gJ3NyYy9jb21tb24vaG9va3MvdXNlVXJsU2hvcnRlbmVyJztcbmltcG9ydCBFbWJlZENvZGVCdXR0b24gZnJvbSAnLi9FbWJlZENvZGVCdXR0b24nO1xuaW1wb3J0IENvbm5lY3RlZERpc3BsYXlRdWVyeUJ1dHRvbiBmcm9tICcuL0Rpc3BsYXlRdWVyeUJ1dHRvbic7XG5pbXBvcnQgeyBleHBvcnRDaGFydCwgZ2V0RXhwbG9yZUxvbmdVcmwgfSBmcm9tICcuLi9leHBsb3JlVXRpbHMnO1xuY29uc3QgQWN0aW9uQnV0dG9uID0gKHByb3BzKSA9PiB7XG4gICAgY29uc3QgeyBpY29uLCB0ZXh0LCB0b29sdGlwLCBjbGFzc05hbWUsIG9uVG9vbHRpcFZpc2liaWxpdHlDaGFuZ2UsIC4uLnJlc3QgfSA9IHByb3BzO1xuICAgIHJldHVybiAoPFRvb2x0aXAgaWQ9e2Ake2ljb259LXRvb2x0aXBgfSBwbGFjZW1lbnQ9XCJ0b3BcIiB0aXRsZT17dG9vbHRpcH0gdHJpZ2dlcj17Wydob3ZlciddfSBvblZpc2libGVDaGFuZ2U9e29uVG9vbHRpcFZpc2liaWxpdHlDaGFuZ2V9PlxuICAgICAgPGRpdiByb2xlPVwiYnV0dG9uXCIgdGFiSW5kZXg9ezB9IGNzcz17eyAnJjpmb2N1cywgJjpmb2N1czphY3RpdmUnOiB7IG91dGxpbmU6IDAgfSB9fSBjbGFzc05hbWU9e2NsYXNzTmFtZSB8fCAnYnRuIGJ0bi1kZWZhdWx0IGJ0bi1zbSd9IHN0eWxlPXt7IGhlaWdodDogMzAgfX0gey4uLnJlc3R9PlxuICAgICAgICB7aWNvbn1cbiAgICAgICAge3RleHQgJiYgPHNwYW4gc3R5bGU9e3sgbWFyZ2luTGVmdDogNSB9fT57dGV4dH08L3NwYW4+fVxuICAgICAgPC9kaXY+XG4gICAgPC9Ub29sdGlwPik7XG59O1xuY29uc3QgRXhwbG9yZUFjdGlvbkJ1dHRvbnMgPSAocHJvcHMpID0+IHtcbiAgICBjb25zdCB7IGFjdGlvbnMsIGNhbkRvd25sb2FkLCBjaGFydFN0YXR1cywgbGF0ZXN0UXVlcnlGb3JtRGF0YSwgcXVlcmllc1Jlc3BvbnNlLCBzbGljZSwgYWRkRGFuZ2VyVG9hc3QsIH0gPSBwcm9wcztcbiAgICBjb25zdCBjb3B5VG9vbHRpcFRleHQgPSB0KCdDb3B5IGNoYXJ0IFVSTCB0byBjbGlwYm9hcmQnKTtcbiAgICBjb25zdCBbY29weVRvb2x0aXAsIHNldENvcHlUb29sdGlwXSA9IHVzZVN0YXRlKGNvcHlUb29sdGlwVGV4dCk7XG4gICAgY29uc3QgbG9uZ1VybCA9IGdldEV4cGxvcmVMb25nVXJsKGxhdGVzdFF1ZXJ5Rm9ybURhdGEpO1xuICAgIGNvbnN0IGdldFNob3J0VXJsID0gdXNlVXJsU2hvcnRlbmVyKGxvbmdVcmwpO1xuICAgIGNvbnN0IGRvQ29weUxpbmsgPSBhc3luYyAoKSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBzZXRDb3B5VG9vbHRpcCh0KCdMb2FkaW5nLi4uJykpO1xuICAgICAgICAgICAgY29uc3Qgc2hvcnRVcmwgPSBhd2FpdCBnZXRTaG9ydFVybCgpO1xuICAgICAgICAgICAgYXdhaXQgY29weVRleHRUb0NsaXBib2FyZChzaG9ydFVybCk7XG4gICAgICAgICAgICBzZXRDb3B5VG9vbHRpcCh0KCdDb3BpZWQgdG8gY2xpcGJvYXJkIScpKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHNldENvcHlUb29sdGlwKHQoJ1NvcnJ5LCB5b3VyIGJyb3dzZXIgZG9lcyBub3Qgc3VwcG9ydCBjb3B5aW5nLicpKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgY29uc3QgZG9TaGFyZUVtYWlsID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3Qgc3ViamVjdCA9IHQoJ1N1cGVyc2V0IENoYXJ0Jyk7XG4gICAgICAgICAgICBjb25zdCBzaG9ydFVybCA9IGF3YWl0IGdldFNob3J0VXJsKCk7XG4gICAgICAgICAgICBjb25zdCBib2R5ID0gdCgnJXMlcycsICdDaGVjayBvdXQgdGhpcyBjaGFydDogJywgc2hvcnRVcmwpO1xuICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBgbWFpbHRvOj9TdWJqZWN0PSR7c3ViamVjdH0lMjAmQm9keT0ke2JvZHl9YDtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGFkZERhbmdlclRvYXN0KHQoJ1NvcnJ5LCBzb21ldGhpbmcgd2VudCB3cm9uZy4gVHJ5IGFnYWluIGxhdGVyLicpKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgY29uc3QgZG9FeHBvcnRDU1YgPSBleHBvcnRDaGFydC5iaW5kKHRoaXMsIHtcbiAgICAgICAgZm9ybURhdGE6IGxhdGVzdFF1ZXJ5Rm9ybURhdGEsXG4gICAgICAgIHJlc3VsdFR5cGU6ICdyZXN1bHRzJyxcbiAgICAgICAgcmVzdWx0Rm9ybWF0OiAnY3N2JyxcbiAgICB9KTtcbiAgICBjb25zdCBkb0V4cG9ydENoYXJ0ID0gZXhwb3J0Q2hhcnQuYmluZCh0aGlzLCB7XG4gICAgICAgIGZvcm1EYXRhOiBsYXRlc3RRdWVyeUZvcm1EYXRhLFxuICAgICAgICByZXN1bHRUeXBlOiAncmVzdWx0cycsXG4gICAgICAgIHJlc3VsdEZvcm1hdDogJ2pzb24nLFxuICAgIH0pO1xuICAgIGNvbnN0IGV4cG9ydFRvQ1NWQ2xhc3NlcyA9IGN4KCdidG4gYnRuLWRlZmF1bHQgYnRuLXNtJywge1xuICAgICAgICBkaXNhYmxlZDogIWNhbkRvd25sb2FkLFxuICAgIH0pO1xuICAgIHJldHVybiAoPGRpdiBjbGFzc05hbWU9XCJidG4tZ3JvdXAgcmVzdWx0c1wiIHJvbGU9XCJncm91cFwiIGRhdGEtdGVzdD1cImJ0bi1ncm91cC1yZXN1bHRzXCI+XG4gICAgICB7bGF0ZXN0UXVlcnlGb3JtRGF0YSAmJiAoPD5cbiAgICAgICAgICA8QWN0aW9uQnV0dG9uIGljb249ezxJY29uIG5hbWU9XCJsaW5rXCIgd2lkdGg9ezE1fSBoZWlnaHQ9ezE1fSBzdHlsZT17eyBtYXJnaW5Ub3A6IDEgfX0vPn0gdG9vbHRpcD17Y29weVRvb2x0aXB9IG9uQ2xpY2s9e2RvQ29weUxpbmt9IGRhdGEtdGVzdD1cInNob3J0LWxpbmstYnV0dG9uXCIgb25Ub29sdGlwVmlzaWJpbGl0eUNoYW5nZT17dmFsdWUgPT4gIXZhbHVlICYmIHNldFRpbWVvdXQoKCkgPT4gc2V0Q29weVRvb2x0aXAoY29weVRvb2x0aXBUZXh0KSwgMjAwKX0vPlxuICAgICAgICAgIDxBY3Rpb25CdXR0b24gaWNvbj17PEljb24gbmFtZT1cImVtYWlsXCIgd2lkdGg9ezE1fSBoZWlnaHQ9ezE1fSBzdHlsZT17eyBtYXJnaW5Ub3A6IDEgfX0vPn0gdG9vbHRpcD17dCgnU2hhcmUgY2hhcnQgYnkgZW1haWwnKX0gb25DbGljaz17ZG9TaGFyZUVtYWlsfS8+XG4gICAgICAgICAgPEVtYmVkQ29kZUJ1dHRvbiBsYXRlc3RRdWVyeUZvcm1EYXRhPXtsYXRlc3RRdWVyeUZvcm1EYXRhfS8+XG4gICAgICAgICAgPEFjdGlvbkJ1dHRvbiBpY29uPXs8aSBjbGFzc05hbWU9XCJmYSBmYS1maWxlLWNvZGUtb1wiLz59IHRleHQ9XCIuSlNPTlwiIHRvb2x0aXA9e3QoJ0V4cG9ydCB0byAuSlNPTiBmb3JtYXQnKX0gb25DbGljaz17ZG9FeHBvcnRDaGFydH0vPlxuICAgICAgICAgIDxBY3Rpb25CdXR0b24gaWNvbj17PGkgY2xhc3NOYW1lPVwiZmEgZmEtZmlsZS10ZXh0LW9cIi8+fSB0ZXh0PVwiLkNTVlwiIHRvb2x0aXA9e3QoJ0V4cG9ydCB0byAuQ1NWIGZvcm1hdCcpfSBvbkNsaWNrPXtkb0V4cG9ydENTVn0gY2xhc3NOYW1lPXtleHBvcnRUb0NTVkNsYXNzZXN9Lz5cbiAgICAgICAgPC8+KX1cbiAgICAgIDxDb25uZWN0ZWREaXNwbGF5UXVlcnlCdXR0b24gcXVlcnlSZXNwb25zZT17cXVlcmllc1Jlc3BvbnNlPy5bMF19IGxhdGVzdFF1ZXJ5Rm9ybURhdGE9e2xhdGVzdFF1ZXJ5Rm9ybURhdGF9IGNoYXJ0U3RhdHVzPXtjaGFydFN0YXR1c30gb25PcGVuSW5FZGl0b3I9e2FjdGlvbnMucmVkaXJlY3RTUUxMYWJ9IG9uT3BlblByb3BlcnRpZXNNb2RhbD17YWN0aW9ucy5vcGVuUHJvcGVydGllc01vZGFsfSBzbGljZT17c2xpY2V9Lz5cbiAgICA8L2Rpdj4pO1xufTtcbmV4cG9ydCBkZWZhdWx0IHdpdGhUb2FzdHMoRXhwbG9yZUFjdGlvbkJ1dHRvbnMpO1xuIl19 */\", toString: _EMOTION_STRINGIFIED_CSS_ERROR__ };\nconst ActionButton = props => {\n  const { icon, text, tooltip, className, onTooltipVisibilityChange, ...rest } = props;\n  return ___EmotionJSX(Tooltip, { id: `${icon}-tooltip`, placement: \"top\", title: tooltip, trigger: ['hover'], onVisibleChange: onTooltipVisibilityChange },\n  ___EmotionJSX(\"div\", _extends({ role: \"button\", tabIndex: 0, css: _ref, className: className || 'btn btn-default btn-sm', style: { height: 30 } }, rest),\n  icon,\n  text && ___EmotionJSX(\"span\", { style: { marginLeft: 5 } }, text)));\n\n\n};\nconst ExploreActionButtons = props => {\n  const { actions, canDownload, chartStatus, latestQueryFormData, queriesResponse, slice, addDangerToast } = props;\n  const copyTooltipText = t('Copy chart URL to clipboard');\n  const [copyTooltip, setCopyTooltip] = useState(copyTooltipText);\n  const longUrl = getExploreLongUrl(latestQueryFormData);\n  const getShortUrl = useUrlShortener(longUrl);\n  const doCopyLink = async () => {\n    try {\n      setCopyTooltip(t('Loading...'));\n      const shortUrl = await getShortUrl();\n      await copyTextToClipboard(shortUrl);\n      setCopyTooltip(t('Copied to clipboard!'));\n    }\n    catch (error) {\n      setCopyTooltip(t('Sorry, your browser does not support copying.'));\n    }\n  };\n  const doShareEmail = async () => {\n    try {\n      const subject = t('Superset Chart');\n      const shortUrl = await getShortUrl();\n      const body = t('%s%s', 'Check out this chart: ', shortUrl);\n      window.location.href = `mailto:?Subject=${subject}%20&Body=${body}`;\n    }\n    catch (error) {\n      addDangerToast(t('Sorry, something went wrong. Try again later.'));\n    }\n  };\n  const doExportCSV = _bindInstanceProperty(exportChart).call(exportChart, this, {\n    formData: latestQueryFormData,\n    resultType: 'results',\n    resultFormat: 'csv' });\n\n  const doExportChart = _bindInstanceProperty(exportChart).call(exportChart, this, {\n    formData: latestQueryFormData,\n    resultType: 'results',\n    resultFormat: 'json' });\n\n  const exportToCSVClasses = cx('btn btn-default btn-sm', {\n    disabled: !canDownload });\n\n  return ___EmotionJSX(\"div\", { className: \"btn-group results\", role: \"group\", \"data-test\": \"btn-group-results\" },\n  latestQueryFormData && ___EmotionJSX(React.Fragment, null,\n  ___EmotionJSX(ActionButton, { icon: ___EmotionJSX(Icon, { name: \"link\", width: 15, height: 15, style: { marginTop: 1 } }), tooltip: copyTooltip, onClick: doCopyLink, \"data-test\": \"short-link-button\", onTooltipVisibilityChange: value => !value && _setTimeout(() => setCopyTooltip(copyTooltipText), 200) }),\n  ___EmotionJSX(ActionButton, { icon: ___EmotionJSX(Icon, { name: \"email\", width: 15, height: 15, style: { marginTop: 1 } }), tooltip: t('Share chart by email'), onClick: doShareEmail }),\n  ___EmotionJSX(EmbedCodeButton, { latestQueryFormData: latestQueryFormData }),\n  ___EmotionJSX(ActionButton, { icon: ___EmotionJSX(\"i\", { className: \"fa fa-file-code-o\" }), text: \".JSON\", tooltip: t('Export to .JSON format'), onClick: doExportChart }),\n  ___EmotionJSX(ActionButton, { icon: ___EmotionJSX(\"i\", { className: \"fa fa-file-text-o\" }), text: \".CSV\", tooltip: t('Export to .CSV format'), onClick: doExportCSV, className: exportToCSVClasses })),\n\n  ___EmotionJSX(ConnectedDisplayQueryButton, { queryResponse: queriesResponse == null ? void 0 : queriesResponse[0], latestQueryFormData: latestQueryFormData, chartStatus: chartStatus, onOpenInEditor: actions.redirectSQLLab, onOpenPropertiesModal: actions.openPropertiesModal, slice: slice }));\n\n};__signature__(ExploreActionButtons, \"useState{[copyTooltip, setCopyTooltip](copyTooltipText)}\\nuseUrlShortener{getShortUrl}\", () => [useUrlShortener]);const _default =\nwithToasts(ExploreActionButtons);export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(ActionButton, \"ActionButton\", \"/app/superset-frontend/src/explore/components/ExploreActionButtons.tsx\");reactHotLoader.register(ExploreActionButtons, \"ExploreActionButtons\", \"/app/superset-frontend/src/explore/components/ExploreActionButtons.tsx\");reactHotLoader.register(_default, \"default\", \"/app/superset-frontend/src/explore/components/ExploreActionButtons.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"sources":["/app/superset-frontend/src/explore/components/ExploreActionButtons.tsx"],"names":[],"mappings":"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","sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useState } from 'react';\nimport cx from 'classnames';\nimport { t } from '@superset-ui/core';\nimport Icon from 'src/components/Icon';\nimport { Tooltip } from 'src/common/components/Tooltip';\nimport copyTextToClipboard from 'src/utils/copy';\nimport withToasts from 'src/messageToasts/enhancers/withToasts';\nimport { useUrlShortener } from 'src/common/hooks/useUrlShortener';\nimport EmbedCodeButton from './EmbedCodeButton';\nimport ConnectedDisplayQueryButton from './DisplayQueryButton';\nimport { exportChart, getExploreLongUrl } from '../exploreUtils';\n\ntype ActionButtonProps = {\n  icon: React.ReactElement;\n  text?: string;\n  tooltip: string;\n  className?: string;\n  onClick: React.MouseEventHandler<HTMLElement>;\n  onTooltipVisibilityChange?: (visible: boolean) => void;\n  'data-test'?: string;\n};\n\ntype ExploreActionButtonsProps = {\n  actions: { redirectSQLLab: Function; openPropertiesModal: Function };\n  canDownload: boolean;\n  chartStatus: string;\n  latestQueryFormData: {};\n  queriesResponse: {};\n  slice: { slice_name: string };\n  addDangerToast: Function;\n};\n\nconst ActionButton = (props: ActionButtonProps) => {\n  const {\n    icon,\n    text,\n    tooltip,\n    className,\n    onTooltipVisibilityChange,\n    ...rest\n  } = props;\n  return (\n    <Tooltip\n      id={`${icon}-tooltip`}\n      placement=\"top\"\n      title={tooltip}\n      trigger={['hover']}\n      onVisibleChange={onTooltipVisibilityChange}\n    >\n      <div\n        role=\"button\"\n        tabIndex={0}\n        css={{ '&:focus, &:focus:active': { outline: 0 } }}\n        className={className || 'btn btn-default btn-sm'}\n        style={{ height: 30 }}\n        {...rest}\n      >\n        {icon}\n        {text && <span style={{ marginLeft: 5 }}>{text}</span>}\n      </div>\n    </Tooltip>\n  );\n};\n\nconst ExploreActionButtons = (props: ExploreActionButtonsProps) => {\n  const {\n    actions,\n    canDownload,\n    chartStatus,\n    latestQueryFormData,\n    queriesResponse,\n    slice,\n    addDangerToast,\n  } = props;\n\n  const copyTooltipText = t('Copy chart URL to clipboard');\n  const [copyTooltip, setCopyTooltip] = useState(copyTooltipText);\n  const longUrl = getExploreLongUrl(latestQueryFormData);\n  const getShortUrl = useUrlShortener(longUrl);\n\n  const doCopyLink = async () => {\n    try {\n      setCopyTooltip(t('Loading...'));\n      const shortUrl = await getShortUrl();\n      await copyTextToClipboard(shortUrl);\n      setCopyTooltip(t('Copied to clipboard!'));\n    } catch (error) {\n      setCopyTooltip(t('Sorry, your browser does not support copying.'));\n    }\n  };\n\n  const doShareEmail = async () => {\n    try {\n      const subject = t('Superset Chart');\n      const shortUrl = await getShortUrl();\n      const body = t('%s%s', 'Check out this chart: ', shortUrl);\n      window.location.href = `mailto:?Subject=${subject}%20&Body=${body}`;\n    } catch (error) {\n      addDangerToast(t('Sorry, something went wrong. Try again later.'));\n    }\n  };\n\n  const doExportCSV = exportChart.bind(this, {\n    formData: latestQueryFormData,\n    resultType: 'results',\n    resultFormat: 'csv',\n  });\n\n  const doExportChart = exportChart.bind(this, {\n    formData: latestQueryFormData,\n    resultType: 'results',\n    resultFormat: 'json',\n  });\n\n  const exportToCSVClasses = cx('btn btn-default btn-sm', {\n    disabled: !canDownload,\n  });\n\n  return (\n    <div\n      className=\"btn-group results\"\n      role=\"group\"\n      data-test=\"btn-group-results\"\n    >\n      {latestQueryFormData && (\n        <>\n          <ActionButton\n            icon={\n              <Icon\n                name=\"link\"\n                width={15}\n                height={15}\n                style={{ marginTop: 1 }}\n              />\n            }\n            tooltip={copyTooltip}\n            onClick={doCopyLink}\n            data-test=\"short-link-button\"\n            onTooltipVisibilityChange={value =>\n              !value && setTimeout(() => setCopyTooltip(copyTooltipText), 200)\n            }\n          />\n          <ActionButton\n            icon={\n              <Icon\n                name=\"email\"\n                width={15}\n                height={15}\n                style={{ marginTop: 1 }}\n              />\n            }\n            tooltip={t('Share chart by email')}\n            onClick={doShareEmail}\n          />\n          <EmbedCodeButton latestQueryFormData={latestQueryFormData} />\n          <ActionButton\n            icon={<i className=\"fa fa-file-code-o\" />}\n            text=\".JSON\"\n            tooltip={t('Export to .JSON format')}\n            onClick={doExportChart}\n          />\n          <ActionButton\n            icon={<i className=\"fa fa-file-text-o\" />}\n            text=\".CSV\"\n            tooltip={t('Export to .CSV format')}\n            onClick={doExportCSV}\n            className={exportToCSVClasses}\n          />\n        </>\n      )}\n      <ConnectedDisplayQueryButton\n        queryResponse={queriesResponse?.[0]}\n        latestQueryFormData={latestQueryFormData}\n        chartStatus={chartStatus}\n        onOpenInEditor={actions.redirectSQLLab}\n        onOpenPropertiesModal={actions.openPropertiesModal}\n        slice={slice}\n      />\n    </div>\n  );\n};\n\nexport default withToasts(ExploreActionButtons);\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}