{"ast":null,"code":"import _extends from \"@babel/runtime-corejs3/helpers/extends\";import _mapInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/map\";import _filterInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/filter\";import _concatInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/concat\";import _Object$assign from \"@babel/runtime-corejs3/core-js-stable/object/assign\";import _bindInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/bind\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { ListGroup, ListGroupItem } from 'react-bootstrap';\nimport shortid from 'shortid';\nimport {\nSortableContainer,\nSortableHandle,\nSortableElement,\narrayMove } from\n'react-sortable-hoc';\n\nimport { InfoTooltipWithTrigger } from '@superset-ui/chart-controls';\nimport ControlHeader from '../ControlHeader';\nimport controlMap from '.';\nimport './CollectionControl.less';import { jsx as ___EmotionJSX } from \"@emotion/core\";\n\nconst propTypes = {\n  name: PropTypes.string.isRequired,\n  label: PropTypes.string,\n  description: PropTypes.string,\n  placeholder: PropTypes.string,\n  addTooltip: PropTypes.string,\n  itemGenerator: PropTypes.func,\n  keyAccessor: PropTypes.func,\n  onChange: PropTypes.func,\n  value: PropTypes.oneOfType([PropTypes.array]),\n  isFloat: PropTypes.bool,\n  isInt: PropTypes.bool,\n  controlName: PropTypes.string.isRequired };\n\n\nconst defaultProps = {\n  label: null,\n  description: null,\n  onChange: () => {},\n  placeholder: 'Empty collection',\n  itemGenerator: () => ({ key: shortid.generate() }),\n  keyAccessor: o => o.key,\n  value: [],\n  addTooltip: 'Add an item' };\n\nconst SortableListGroupItem = SortableElement(ListGroupItem);\nconst SortableListGroup = SortableContainer(ListGroup);\nconst SortableDragger = SortableHandle(() =>\n___EmotionJSX(\"i\", { className: \"fa fa-bars text-primary\", style: { cursor: 'ns-resize' } }));\n\n\nexport default class CollectionControl extends React.Component {\n  constructor(props) {var _context;\n    super(props);\n    this.onAdd = _bindInstanceProperty(_context = this.onAdd).call(_context, this);\n  }\n\n  onChange(i, value) {\n    _Object$assign(this.props.value[i], value);\n    this.props.onChange(this.props.value);\n  }\n\n  onAdd() {var _context2;\n    this.props.onChange(_concatInstanceProperty(_context2 = this.props.value).call(_context2, [this.props.itemGenerator()]));\n  }\n\n  onSortEnd({ oldIndex, newIndex }) {\n    this.props.onChange(arrayMove(this.props.value, oldIndex, newIndex));\n  }\n\n  removeItem(i) {var _context3;\n    this.props.onChange(_filterInstanceProperty(_context3 = this.props.value).call(_context3, (o, ix) => i !== ix));\n  }\n\n  renderList() {var _context4, _context5;\n    if (this.props.value.length === 0) {\n      return ___EmotionJSX(\"div\", { className: \"text-muted\" }, this.props.placeholder);\n    }\n    const Control = controlMap[this.props.controlName];\n    return (\n      ___EmotionJSX(SortableListGroup, {\n        useDragHandle: true,\n        lockAxis: \"y\",\n        onSortEnd: _bindInstanceProperty(_context4 = this.onSortEnd).call(_context4, this) },\n\n      _mapInstanceProperty(_context5 = this.props.value).call(_context5, (o, i) => {var _context6, _context7;\n        // label relevant only for header, not here\n        const { label, ...commonProps } = this.props;\n        return (\n          ___EmotionJSX(SortableListGroupItem, {\n            className: \"clearfix\",\n            key: this.props.keyAccessor(o),\n            index: i },\n\n          ___EmotionJSX(\"div\", { className: \"pull-left m-r-5\" },\n          ___EmotionJSX(SortableDragger, null)),\n\n          ___EmotionJSX(\"div\", { className: \"pull-left\" },\n          ___EmotionJSX(Control, _extends({},\n          commonProps,\n          o, {\n            onChange: _bindInstanceProperty(_context6 = this.onChange).call(_context6, this, i) }))),\n\n\n          ___EmotionJSX(\"div\", { className: \"pull-right\" },\n          ___EmotionJSX(InfoTooltipWithTrigger, {\n            icon: \"times\",\n            label: \"remove-item\",\n            tooltip: \"remove item\",\n            bsStyle: \"primary\",\n            onClick: _bindInstanceProperty(_context7 = this.removeItem).call(_context7, this, i) }))));\n\n\n\n\n      })));\n\n\n  }\n\n  render() {\n    return (\n      ___EmotionJSX(\"div\", { className: \"CollectionControl\" },\n      ___EmotionJSX(ControlHeader, this.props),\n      this.renderList(),\n      ___EmotionJSX(InfoTooltipWithTrigger, {\n        icon: \"plus-circle\",\n        label: \"add-item\",\n        tooltip: this.props.addTooltip,\n        bsStyle: \"primary\",\n        className: \"fa-lg\",\n        onClick: this.onAdd })));\n\n\n\n  } // @ts-ignore\n  __reactstandin__regenerateByEval(key, code) {// @ts-ignore\n    this[key] = eval(code);}}\nCollectionControl.propTypes = propTypes;\nCollectionControl.defaultProps = defaultProps;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(propTypes, \"propTypes\", \"/app/superset-frontend/src/explore/components/controls/CollectionControl.jsx\");reactHotLoader.register(defaultProps, \"defaultProps\", \"/app/superset-frontend/src/explore/components/controls/CollectionControl.jsx\");reactHotLoader.register(SortableListGroupItem, \"SortableListGroupItem\", \"/app/superset-frontend/src/explore/components/controls/CollectionControl.jsx\");reactHotLoader.register(SortableListGroup, \"SortableListGroup\", \"/app/superset-frontend/src/explore/components/controls/CollectionControl.jsx\");reactHotLoader.register(SortableDragger, \"SortableDragger\", \"/app/superset-frontend/src/explore/components/controls/CollectionControl.jsx\");reactHotLoader.register(CollectionControl, \"CollectionControl\", \"/app/superset-frontend/src/explore/components/controls/CollectionControl.jsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"sources":["/app/superset-frontend/src/explore/components/controls/CollectionControl.jsx"],"names":["React","PropTypes","ListGroup","ListGroupItem","shortid","SortableContainer","SortableHandle","SortableElement","arrayMove","InfoTooltipWithTrigger","ControlHeader","controlMap","propTypes","name","string","isRequired","label","description","placeholder","addTooltip","itemGenerator","func","keyAccessor","onChange","value","oneOfType","array","isFloat","bool","isInt","controlName","defaultProps","key","generate","o","SortableListGroupItem","SortableListGroup","SortableDragger","cursor","CollectionControl","Component","constructor","props","onAdd","i","onSortEnd","oldIndex","newIndex","removeItem","ix","renderList","length","Control","commonProps","render"],"mappings":"6xBAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,SAASC,SAAT,EAAoBC,aAApB,QAAyC,iBAAzC;AACA,OAAOC,OAAP,MAAoB,SAApB;AACA;AACEC,iBADF;AAEEC,cAFF;AAGEC,eAHF;AAIEC,SAJF;AAKO,oBALP;;AAOA,SAASC,sBAAT,QAAuC,6BAAvC;AACA,OAAOC,aAAP,MAA0B,kBAA1B;AACA,OAAOC,UAAP,MAAuB,GAAvB;AACA,OAAO,0BAAP,C;;AAEA,MAAMC,SAAS,GAAG;AAChBC,EAAAA,IAAI,EAAEZ,SAAS,CAACa,MAAV,CAAiBC,UADP;AAEhBC,EAAAA,KAAK,EAAEf,SAAS,CAACa,MAFD;AAGhBG,EAAAA,WAAW,EAAEhB,SAAS,CAACa,MAHP;AAIhBI,EAAAA,WAAW,EAAEjB,SAAS,CAACa,MAJP;AAKhBK,EAAAA,UAAU,EAAElB,SAAS,CAACa,MALN;AAMhBM,EAAAA,aAAa,EAAEnB,SAAS,CAACoB,IANT;AAOhBC,EAAAA,WAAW,EAAErB,SAAS,CAACoB,IAPP;AAQhBE,EAAAA,QAAQ,EAAEtB,SAAS,CAACoB,IARJ;AAShBG,EAAAA,KAAK,EAAEvB,SAAS,CAACwB,SAAV,CAAoB,CAACxB,SAAS,CAACyB,KAAX,CAApB,CATS;AAUhBC,EAAAA,OAAO,EAAE1B,SAAS,CAAC2B,IAVH;AAWhBC,EAAAA,KAAK,EAAE5B,SAAS,CAAC2B,IAXD;AAYhBE,EAAAA,WAAW,EAAE7B,SAAS,CAACa,MAAV,CAAiBC,UAZd,EAAlB;;;AAeA,MAAMgB,YAAY,GAAG;AACnBf,EAAAA,KAAK,EAAE,IADY;AAEnBC,EAAAA,WAAW,EAAE,IAFM;AAGnBM,EAAAA,QAAQ,EAAE,MAAM,CAAE,CAHC;AAInBL,EAAAA,WAAW,EAAE,kBAJM;AAKnBE,EAAAA,aAAa,EAAE,OAAO,EAAEY,GAAG,EAAE5B,OAAO,CAAC6B,QAAR,EAAP,EAAP,CALI;AAMnBX,EAAAA,WAAW,EAAEY,CAAC,IAAIA,CAAC,CAACF,GAND;AAOnBR,EAAAA,KAAK,EAAE,EAPY;AAQnBL,EAAAA,UAAU,EAAE,aARO,EAArB;;AAUA,MAAMgB,qBAAqB,GAAG5B,eAAe,CAACJ,aAAD,CAA7C;AACA,MAAMiC,iBAAiB,GAAG/B,iBAAiB,CAACH,SAAD,CAA3C;AACA,MAAMmC,eAAe,GAAG/B,cAAc,CAAC;AACrC,qBAAG,SAAS,EAAC,yBAAb,EAAuC,KAAK,EAAE,EAAEgC,MAAM,EAAE,WAAV,EAA9C,GADoC,CAAtC;;;AAIA,eAAe,MAAMC,iBAAN,SAAgCvC,KAAK,CAACwC,SAAtC,CAAgD;AAC7DC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;AACA,SAAKC,KAAL,GAAa,sCAAKA,KAAL,iBAAgB,IAAhB,CAAb;AACD;;AAEDpB,EAAAA,QAAQ,CAACqB,CAAD,EAAIpB,KAAJ,EAAW;AACjB,mBAAc,KAAKkB,KAAL,CAAWlB,KAAX,CAAiBoB,CAAjB,CAAd,EAAmCpB,KAAnC;AACA,SAAKkB,KAAL,CAAWnB,QAAX,CAAoB,KAAKmB,KAAL,CAAWlB,KAA/B;AACD;;AAEDmB,EAAAA,KAAK,GAAG;AACN,SAAKD,KAAL,CAAWnB,QAAX,CAAoB,yCAAKmB,KAAL,CAAWlB,KAAX,kBAAwB,CAAC,KAAKkB,KAAL,CAAWtB,aAAX,EAAD,CAAxB,CAApB;AACD;;AAEDyB,EAAAA,SAAS,CAAC,EAAEC,QAAF,EAAYC,QAAZ,EAAD,EAAyB;AAChC,SAAKL,KAAL,CAAWnB,QAAX,CAAoBf,SAAS,CAAC,KAAKkC,KAAL,CAAWlB,KAAZ,EAAmBsB,QAAnB,EAA6BC,QAA7B,CAA7B;AACD;;AAEDC,EAAAA,UAAU,CAACJ,CAAD,EAAI;AACZ,SAAKF,KAAL,CAAWnB,QAAX,CAAoB,yCAAKmB,KAAL,CAAWlB,KAAX,kBAAwB,CAACU,CAAD,EAAIe,EAAJ,KAAWL,CAAC,KAAKK,EAAzC,CAApB;AACD;;AAEDC,EAAAA,UAAU,GAAG;AACX,QAAI,KAAKR,KAAL,CAAWlB,KAAX,CAAiB2B,MAAjB,KAA4B,CAAhC,EAAmC;AACjC,aAAO,uBAAK,SAAS,EAAC,YAAf,IAA6B,KAAKT,KAAL,CAAWxB,WAAxC,CAAP;AACD;AACD,UAAMkC,OAAO,GAAGzC,UAAU,CAAC,KAAK+B,KAAL,CAAWZ,WAAZ,CAA1B;AACA;AACE,oBAAC,iBAAD;AACE,QAAA,aAAa,MADf;AAEE,QAAA,QAAQ,EAAC,GAFX;AAGE,QAAA,SAAS,EAAE,uCAAKe,SAAL,kBAAoB,IAApB,CAHb;;AAKG,4CAAKH,KAAL,CAAWlB,KAAX,kBAAqB,CAACU,CAAD,EAAIU,CAAJ,KAAU;AAC9B;AACA,cAAM,EAAE5B,KAAF,EAAS,GAAGqC,WAAZ,KAA4B,KAAKX,KAAvC;AACA;AACE,wBAAC,qBAAD;AACE,YAAA,SAAS,EAAC,UADZ;AAEE,YAAA,GAAG,EAAE,KAAKA,KAAL,CAAWpB,WAAX,CAAuBY,CAAvB,CAFP;AAGE,YAAA,KAAK,EAAEU,CAHT;;AAKE,iCAAK,SAAS,EAAC,iBAAf;AACE,wBAAC,eAAD,OADF,CALF;;AAQE,iCAAK,SAAS,EAAC,WAAf;AACE,wBAAC,OAAD;AACMS,UAAAA,WADN;AAEMnB,UAAAA,CAFN;AAGE,YAAA,QAAQ,EAAE,uCAAKX,QAAL,kBAAmB,IAAnB,EAAyBqB,CAAzB,CAHZ,IADF,CARF;;;AAeE,iCAAK,SAAS,EAAC,YAAf;AACE,wBAAC,sBAAD;AACE,YAAA,IAAI,EAAC,OADP;AAEE,YAAA,KAAK,EAAC,aAFR;AAGE,YAAA,OAAO,EAAC,aAHV;AAIE,YAAA,OAAO,EAAC,SAJV;AAKE,YAAA,OAAO,EAAE,uCAAKI,UAAL,kBAAqB,IAArB,EAA2BJ,CAA3B,CALX,GADF,CAfF,CADF;;;;;AA2BD,OA9BA,CALH,CADF;;;AAuCD;;AAEDU,EAAAA,MAAM,GAAG;AACP;AACE,6BAAK,SAAS,EAAC,mBAAf;AACE,oBAAC,aAAD,EAAmB,KAAKZ,KAAxB,CADF;AAEG,WAAKQ,UAAL,EAFH;AAGE,oBAAC,sBAAD;AACE,QAAA,IAAI,EAAC,aADP;AAEE,QAAA,KAAK,EAAC,UAFR;AAGE,QAAA,OAAO,EAAE,KAAKR,KAAL,CAAWvB,UAHtB;AAIE,QAAA,OAAO,EAAC,SAJV;AAKE,QAAA,SAAS,EAAC,OALZ;AAME,QAAA,OAAO,EAAE,KAAKwB,KANhB,GAHF,CADF;;;;AAcD,GApF4D;AAAA;AAAA;AAuF/DJ,iBAAiB,CAAC3B,SAAlB,GAA8BA,SAA9B;AACA2B,iBAAiB,CAACR,YAAlB,GAAiCA,YAAjC,C,iLAvHMnB,S,uHAeAmB,Y,0HAUAI,qB,mIACAC,iB,+HACAC,e,6HAIeE,iB","sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { ListGroup, ListGroupItem } from 'react-bootstrap';\nimport shortid from 'shortid';\nimport {\n  SortableContainer,\n  SortableHandle,\n  SortableElement,\n  arrayMove,\n} from 'react-sortable-hoc';\n\nimport { InfoTooltipWithTrigger } from '@superset-ui/chart-controls';\nimport ControlHeader from '../ControlHeader';\nimport controlMap from '.';\nimport './CollectionControl.less';\n\nconst propTypes = {\n  name: PropTypes.string.isRequired,\n  label: PropTypes.string,\n  description: PropTypes.string,\n  placeholder: PropTypes.string,\n  addTooltip: PropTypes.string,\n  itemGenerator: PropTypes.func,\n  keyAccessor: PropTypes.func,\n  onChange: PropTypes.func,\n  value: PropTypes.oneOfType([PropTypes.array]),\n  isFloat: PropTypes.bool,\n  isInt: PropTypes.bool,\n  controlName: PropTypes.string.isRequired,\n};\n\nconst defaultProps = {\n  label: null,\n  description: null,\n  onChange: () => {},\n  placeholder: 'Empty collection',\n  itemGenerator: () => ({ key: shortid.generate() }),\n  keyAccessor: o => o.key,\n  value: [],\n  addTooltip: 'Add an item',\n};\nconst SortableListGroupItem = SortableElement(ListGroupItem);\nconst SortableListGroup = SortableContainer(ListGroup);\nconst SortableDragger = SortableHandle(() => (\n  <i className=\"fa fa-bars text-primary\" style={{ cursor: 'ns-resize' }} />\n));\n\nexport default class CollectionControl extends React.Component {\n  constructor(props) {\n    super(props);\n    this.onAdd = this.onAdd.bind(this);\n  }\n\n  onChange(i, value) {\n    Object.assign(this.props.value[i], value);\n    this.props.onChange(this.props.value);\n  }\n\n  onAdd() {\n    this.props.onChange(this.props.value.concat([this.props.itemGenerator()]));\n  }\n\n  onSortEnd({ oldIndex, newIndex }) {\n    this.props.onChange(arrayMove(this.props.value, oldIndex, newIndex));\n  }\n\n  removeItem(i) {\n    this.props.onChange(this.props.value.filter((o, ix) => i !== ix));\n  }\n\n  renderList() {\n    if (this.props.value.length === 0) {\n      return <div className=\"text-muted\">{this.props.placeholder}</div>;\n    }\n    const Control = controlMap[this.props.controlName];\n    return (\n      <SortableListGroup\n        useDragHandle\n        lockAxis=\"y\"\n        onSortEnd={this.onSortEnd.bind(this)}\n      >\n        {this.props.value.map((o, i) => {\n          // label relevant only for header, not here\n          const { label, ...commonProps } = this.props;\n          return (\n            <SortableListGroupItem\n              className=\"clearfix\"\n              key={this.props.keyAccessor(o)}\n              index={i}\n            >\n              <div className=\"pull-left m-r-5\">\n                <SortableDragger />\n              </div>\n              <div className=\"pull-left\">\n                <Control\n                  {...commonProps}\n                  {...o}\n                  onChange={this.onChange.bind(this, i)}\n                />\n              </div>\n              <div className=\"pull-right\">\n                <InfoTooltipWithTrigger\n                  icon=\"times\"\n                  label=\"remove-item\"\n                  tooltip=\"remove item\"\n                  bsStyle=\"primary\"\n                  onClick={this.removeItem.bind(this, i)}\n                />\n              </div>\n            </SortableListGroupItem>\n          );\n        })}\n      </SortableListGroup>\n    );\n  }\n\n  render() {\n    return (\n      <div className=\"CollectionControl\">\n        <ControlHeader {...this.props} />\n        {this.renderList()}\n        <InfoTooltipWithTrigger\n          icon=\"plus-circle\"\n          label=\"add-item\"\n          tooltip={this.props.addTooltip}\n          bsStyle=\"primary\"\n          className=\"fa-lg\"\n          onClick={this.onAdd}\n        />\n      </div>\n    );\n  }\n}\n\nCollectionControl.propTypes = propTypes;\nCollectionControl.defaultProps = defaultProps;\n"]},"metadata":{},"sourceType":"module"}