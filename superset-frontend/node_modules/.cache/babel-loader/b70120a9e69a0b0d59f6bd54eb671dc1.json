{"ast":null,"code":"import \"core-js/modules/web.dom-collections.iterator.js\";import _Object$values from \"@babel/runtime-corejs3/core-js-stable/object/values\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint-env browser */\nimport cx from 'classnames';\nimport React, { useEffect, useState } from 'react';\nimport { Sticky, StickyContainer } from 'react-sticky';\nimport { styled } from '@superset-ui/core';\nimport ErrorBoundary from 'src/components/ErrorBoundary';\nimport BuilderComponentPane from 'src/dashboard/components/BuilderComponentPane';\nimport DashboardHeader from 'src/dashboard/containers/DashboardHeader';\nimport IconButton from 'src/dashboard/components/IconButton';\nimport DragDroppable from 'src/dashboard/components/dnd/DragDroppable';\nimport DashboardComponent from 'src/dashboard/containers/DashboardComponent';\nimport ToastPresenter from 'src/messageToasts/containers/ToastPresenter';\nimport WithPopoverMenu from 'src/dashboard/components/menu/WithPopoverMenu';\nimport getDirectPathToTabIndex from 'src/dashboard/util/getDirectPathToTabIndex';\nimport { FeatureFlag, isFeatureEnabled } from 'src/featureFlags';\nimport { URL_PARAMS } from 'src/constants';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { getUrlParam } from 'src/utils/urlUtils';\nimport { setDirectPathToChild } from 'src/dashboard/actions/dashboardState';\nimport { deleteTopLevelTabs, handleComponentDrop } from 'src/dashboard/actions/dashboardLayout';\nimport { DASHBOARD_GRID_ID, DASHBOARD_ROOT_ID, DASHBOARD_ROOT_DEPTH, DashboardStandaloneMode } from 'src/dashboard/util/constants';\nimport FilterBar from '../nativeFilters/FilterBar/FilterBar';\nimport { StickyVerticalBar } from '../StickyVerticalBar';\nimport { shouldFocusTabs, getRootLevelTabsComponent } from './utils';\nimport { useFilters } from '../nativeFilters/FilterBar/state';\nimport DashboardContainer from './DashboardContainer';import { jsx as ___EmotionJSX } from \"@emotion/core\";\nconst TABS_HEIGHT = 47;\nconst HEADER_HEIGHT = 67;\nconst StyledDashboardContent = styled.div`\n  display: flex;\n  flex-direction: row;\n  flex-wrap: nowrap;\n  height: auto;\n  flex-grow: 1;\n\n  .grid-container .dashboard-component-tabs {\n    box-shadow: none;\n    padding-left: 0;\n  }\n\n  .grid-container {\n    /* without this, the grid will not get smaller upon toggling the builder panel on */\n    min-width: 0;\n    width: 100%;\n    flex-grow: 1;\n    position: relative;\n    margin: ${({ theme }) => theme.gridUnit * 6}px\n      ${({ theme }) => theme.gridUnit * 8}px\n      ${({ theme }) => theme.gridUnit * 6}px\n      ${({ theme, dashboardFiltersOpen }) => {\n  if (dashboardFiltersOpen)\n  return theme.gridUnit * 8;\n  return 0;\n}}px;\n  }\n\n  .dashboard-component-chart-holder {\n    // transitionable traits to show filter relevance\n    transition: opacity ${({ theme }) => theme.transitionTiming}s,\n      border-color ${({ theme }) => theme.transitionTiming}s,\n      box-shadow ${({ theme }) => theme.transitionTiming}s;\n    border: 0 solid transparent;\n  }\n`;\nconst DashboardBuilder = () => {\n  const dispatch = useDispatch();\n  const dashboardLayout = useSelector(state => state.dashboardLayout.present);\n  const editMode = useSelector(state => state.dashboardState.editMode);\n  const directPathToChild = useSelector(state => state.dashboardState.directPathToChild);\n  const filters = useFilters();\n  const filterValues = _Object$values(filters);\n  const nativeFiltersEnabled = isFeatureEnabled(FeatureFlag.DASHBOARD_NATIVE_FILTERS);\n  const [dashboardFiltersOpen, setDashboardFiltersOpen] = useState(true);\n  const toggleDashboardFiltersOpen = visible => {\n    setDashboardFiltersOpen(visible != null ? visible : !dashboardFiltersOpen);\n  };\n  const handleChangeTab = ({ pathToTabIndex }) => {\n    dispatch(setDirectPathToChild(pathToTabIndex));\n  };\n  const handleDeleteTopLevelTabs = () => {\n    dispatch(deleteTopLevelTabs());\n    const firstTab = getDirectPathToTabIndex(getRootLevelTabsComponent(dashboardLayout), 0);\n    dispatch(setDirectPathToChild(firstTab));\n  };\n  const dashboardRoot = dashboardLayout[DASHBOARD_ROOT_ID];\n  const rootChildId = dashboardRoot.children[0];\n  const topLevelTabs = rootChildId !== DASHBOARD_GRID_ID ?\n  dashboardLayout[rootChildId] :\n  undefined;\n  const hideDashboardHeader = getUrlParam(URL_PARAMS.standalone, 'number') ===\n  DashboardStandaloneMode.HIDE_NAV_AND_TITLE;\n  const barTopOffset = (hideDashboardHeader ? 0 : HEADER_HEIGHT) + (\n  topLevelTabs ? TABS_HEIGHT : 0);\n  useEffect(() => {\n    if (filterValues.length === 0 &&\n    dashboardFiltersOpen &&\n    nativeFiltersEnabled) {\n      toggleDashboardFiltersOpen(false);\n    }\n  }, [filterValues.length]);\n  return ___EmotionJSX(StickyContainer, { className: cx('dashboard', editMode && 'dashboard--editing') },\n  ___EmotionJSX(Sticky, null,\n  ({ style }) =>\n  // @ts-ignore\n  ___EmotionJSX(DragDroppable, { component: dashboardRoot, parentComponent: null, depth: DASHBOARD_ROOT_DEPTH, index: 0, orientation: \"column\", onDrop: () => dispatch(handleComponentDrop), editMode: editMode\n    // you cannot drop on/displace tabs if they already exist\n    , disableDragdrop: !!topLevelTabs, style: {\n      zIndex: 100,\n      ...style } },\n\n  ({ dropIndicatorProps }) => ___EmotionJSX(\"div\", null,\n  !hideDashboardHeader && ___EmotionJSX(DashboardHeader, null),\n  dropIndicatorProps && ___EmotionJSX(\"div\", dropIndicatorProps),\n  topLevelTabs && ___EmotionJSX(WithPopoverMenu, { shouldFocus: shouldFocusTabs, menuItems: [\n    ___EmotionJSX(IconButton, { className: \"fa fa-level-down\", label: \"Collapse tab content\", onClick: handleDeleteTopLevelTabs })],\n    editMode: editMode },\n\n  ___EmotionJSX(DashboardComponent, { id: topLevelTabs == null ? void 0 : topLevelTabs.id, parentId: DASHBOARD_ROOT_ID, depth: DASHBOARD_ROOT_DEPTH + 1, index: 0, renderTabContent: false, renderHoverMenu: false, onChangeTab: handleChangeTab }))))),\n\n\n\n\n  ___EmotionJSX(StyledDashboardContent, { className: \"dashboard-content\", dashboardFiltersOpen: dashboardFiltersOpen },\n  nativeFiltersEnabled && !editMode && ___EmotionJSX(StickyVerticalBar, { filtersOpen: dashboardFiltersOpen, topOffset: barTopOffset },\n  ___EmotionJSX(ErrorBoundary, null,\n  ___EmotionJSX(FilterBar, { filtersOpen: dashboardFiltersOpen, toggleFiltersBar: toggleDashboardFiltersOpen, directPathToChild: directPathToChild }))),\n\n\n  ___EmotionJSX(DashboardContainer, { topLevelTabs: topLevelTabs, handleChangeTab: handleChangeTab }),\n  editMode && ___EmotionJSX(BuilderComponentPane, { topOffset: barTopOffset })),\n\n  ___EmotionJSX(ToastPresenter, null));\n\n};__signature__(DashboardBuilder, \"useDispatch{dispatch}\\nuseSelector{dashboardLayout}\\nuseSelector{editMode}\\nuseSelector{directPathToChild}\\nuseFilters{filters}\\nuseState{[dashboardFiltersOpen, setDashboardFiltersOpen](true)}\\nuseEffect{}\", () => [useDispatch, useSelector, useSelector, useSelector, useFilters]);const _default =\nDashboardBuilder;export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(TABS_HEIGHT, \"TABS_HEIGHT\", \"/app/superset-frontend/src/dashboard/components/DashboardBuilder/DashboardBuilder.tsx\");reactHotLoader.register(HEADER_HEIGHT, \"HEADER_HEIGHT\", \"/app/superset-frontend/src/dashboard/components/DashboardBuilder/DashboardBuilder.tsx\");reactHotLoader.register(StyledDashboardContent, \"StyledDashboardContent\", \"/app/superset-frontend/src/dashboard/components/DashboardBuilder/DashboardBuilder.tsx\");reactHotLoader.register(DashboardBuilder, \"DashboardBuilder\", \"/app/superset-frontend/src/dashboard/components/DashboardBuilder/DashboardBuilder.tsx\");reactHotLoader.register(_default, \"default\", \"/app/superset-frontend/src/dashboard/components/DashboardBuilder/DashboardBuilder.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"sources":["/app/superset-frontend/src/dashboard/components/DashboardBuilder/DashboardBuilder.tsx"],"names":[],"mappings":"kbAAA;;;;;;;;;;;;;;;;;AAiBG;AACH;AACA,OAAO,EAAP,MAAe,YAAf;AACA,OAAO,KAAP,IAAoC,SAApC,EAA+C,QAA/C,QAA+D,OAA/D;AACA,SAAS,MAAT,EAAiB,eAAjB,QAAwC,cAAxC;AAEA,SAAqB,MAArB,QAAmC,mBAAnC;AAEA,OAAO,aAAP,MAA0B,8BAA1B;AACA,OAAO,oBAAP,MAAiC,+CAAjC;AACA,OAAO,eAAP,MAA4B,0CAA5B;AACA,OAAO,UAAP,MAAuB,qCAAvB;AACA,OAAO,aAAP,MAA0B,4CAA1B;AACA,OAAO,kBAAP,MAA+B,6CAA/B;AACA,OAAO,cAAP,MAA2B,6CAA3B;AACA,OAAO,eAAP,MAA4B,+CAA5B;AAEA,OAAO,uBAAP,MAAoC,4CAApC;AACA,SAAS,WAAT,EAAsB,gBAAtB,QAA8C,kBAA9C;AACA,SAAS,UAAT,QAA2B,eAA3B;AACA,SAAS,WAAT,EAAsB,WAAtB,QAAyC,aAAzC;AACA,SAAS,WAAT,QAA4B,oBAA5B;AAEA,SAAS,oBAAT,QAAqC,sCAArC;AACA,SACE,kBADF,EAEE,mBAFF,QAGO,uCAHP;AAIA,SACE,iBADF,EAEE,iBAFF,EAGE,oBAHF,EAIE,uBAJF,QAKO,8BALP;AAMA,OAAO,SAAP,MAAsB,sCAAtB;AACA,SAAS,iBAAT,QAAkC,sBAAlC;AACA,SAAS,eAAT,EAA0B,yBAA1B,QAA2D,SAA3D;AACA,SAAS,UAAT,QAA2B,kCAA3B;AAEA,OAAO,kBAAP,MAA+B,sBAA/B,C;AAEA,MAAM,WAAW,GAAG,EAApB;AACA,MAAM,aAAa,GAAG,EAAtB;AAIA,MAAM,sBAAsB,GAAG,MAAM,CAAC,GAAsC;;;;;;;;;;;;;;;;;;cAkB9D,CAAC,EAAE,KAAF,EAAD,KAAe,KAAK,CAAC,QAAN,GAAiB,CAAC;QACvC,CAAC,EAAE,KAAF,EAAD,KAAe,KAAK,CAAC,QAAN,GAAiB,CAAC;QACjC,CAAC,EAAE,KAAF,EAAD,KAAe,KAAK,CAAC,QAAN,GAAiB,CAAC;QACjC,CAAC,EAAE,KAAF,EAAS,oBAAT,EAAD,KAAoC;AACpC,MAAI,oBAAJ;AAA0B,SAAO,KAAK,CAAC,QAAN,GAAiB,CAAxB;AAC1B,SAAO,CAAP;AACD,CAAA;;;;;0BAKmB,CAAC,EAAE,KAAF,EAAD,KAAe,KAAK,CAAC,gBAAgB;qBAC1C,CAAC,EAAE,KAAF,EAAD,KAAe,KAAK,CAAC,gBAAgB;mBACvC,CAAC,EAAE,KAAF,EAAD,KAAe,KAAK,CAAC,gBAAgB;;;AAGvD,CAlCD;AAoCA,MAAM,gBAAgB,GAA8B,MAAK;AACvD,QAAM,QAAQ,GAAG,WAAW,EAA5B;AACA,QAAM,eAAe,GAAG,WAAW,CACjC,KAAK,IAAI,KAAK,CAAC,eAAN,CAAsB,OADE,CAAnC;AAGA,QAAM,QAAQ,GAAG,WAAW,CAC1B,KAAK,IAAI,KAAK,CAAC,cAAN,CAAqB,QADJ,CAA5B;AAGA,QAAM,iBAAiB,GAAG,WAAW,CACnC,KAAK,IAAI,KAAK,CAAC,cAAN,CAAqB,iBADK,CAArC;AAIA,QAAM,OAAO,GAAG,UAAU,EAA1B;AACA,QAAM,YAAY,GAAG,eAAsB,OAAtB,CAArB;AAEA,QAAM,oBAAoB,GAAG,gBAAgB,CAC3C,WAAW,CAAC,wBAD+B,CAA7C;AAIA,QAAM,CAAC,oBAAD,EAAuB,uBAAvB,IAAkD,QAAQ,CAAC,IAAD,CAAhE;AAEA,QAAM,0BAA0B,GAAI,OAAD,IAAsB;AACvD,IAAA,uBAAuB,CAAC,OAAD,WAAC,OAAD,GAAY,CAAC,oBAAb,CAAvB;AACD,GAFD;AAIA,QAAM,eAAe,GAAG,CAAC,EACvB,cADuB,EAAD,KAEiD;AACvE,IAAA,QAAQ,CAAC,oBAAoB,CAAC,cAAD,CAArB,CAAR;AACD,GAJD;AAMA,QAAM,wBAAwB,GAAG,MAAK;AACpC,IAAA,QAAQ,CAAC,kBAAkB,EAAnB,CAAR;AAEA,UAAM,QAAQ,GAAG,uBAAuB,CACtC,yBAAyB,CAAC,eAAD,CADa,EAEtC,CAFsC,CAAxC;AAIA,IAAA,QAAQ,CAAC,oBAAoB,CAAC,QAAD,CAArB,CAAR;AACD,GARD;AAUA,QAAM,aAAa,GAAG,eAAe,CAAC,iBAAD,CAArC;AACA,QAAM,WAAW,GAAG,aAAa,CAAC,QAAd,CAAuB,CAAvB,CAApB;AACA,QAAM,YAAY,GAChB,WAAW,KAAK,iBAAhB;AACI,EAAA,eAAe,CAAC,WAAD,CADnB;AAEI,EAAA,SAHN;AAKA,QAAM,mBAAmB,GACvB,WAAW,CAAC,UAAU,CAAC,UAAZ,EAAwB,QAAxB,CAAX;AACA,EAAA,uBAAuB,CAAC,kBAF1B;AAIA,QAAM,YAAY,GAChB,CAAC,mBAAmB,GAAG,CAAH,GAAO,aAA3B;AACC,EAAA,YAAY,GAAG,WAAH,GAAiB,CAD9B,CADF;AAIA,EAAA,SAAS,CAAC,MAAK;AACb,QACE,YAAY,CAAC,MAAb,KAAwB,CAAxB;AACA,IAAA,oBADA;AAEA,IAAA,oBAHF,EAIE;AACA,MAAA,0BAA0B,CAAC,KAAD,CAA1B;AACD;AACF,GARQ,EAQN,CAAC,YAAY,CAAC,MAAd,CARM,CAAT;AAUA,SACE,cAAC,eAAD,IACE,SAAS,EAAE,EAAE,CAAC,WAAD,EAAc,QAAQ,IAAI,oBAA1B,CADf;AAGE,gBAAC,MAAD;AACG,GAAC,EAAE,KAAF,EAAD;AACC;AACA,gBAAC,aAAD,IACE,SAAS,EAAE,aADb,EAEE,eAAe,EAAE,IAFnB,EAGE,KAAK,EAAE,oBAHT,EAIE,KAAK,EAAE,CAJT,EAKE,WAAW,EAAC,QALd,EAME,MAAM,EAAE,MAAM,QAAQ,CAAC,mBAAD,CANxB,EAOE,QAAQ,EAAE;AACV;AARF,MASE,eAAe,EAAE,CAAC,CAAC,YATrB,EAUE,KAAK,EAAE;AACL,MAAA,MAAM,EAAE,GADH;AAEL,SAAG,KAFE,EAVT;;AAeG,GAAC,EAAE,kBAAF,EAAD,KACC;AACG,GAAC,mBAAD,IAAwB,cAAC,eAAD,OAD3B;AAEG,EAAA,kBAAkB,IAAI,qBAAS,kBAAT,CAFzB;AAGG,EAAA,YAAY,IACX,cAAC,eAAD,IACE,WAAW,EAAE,eADf,EAEE,SAAS,EAAE;AACT,kBAAC,UAAD,IACE,SAAS,EAAC,kBADZ,EAEE,KAAK,EAAC,sBAFR,EAGE,OAAO,EAAE,wBAHX,GADS,CAFb;AASE,IAAA,QAAQ,EAAE,QATZ;;AAaE,gBAAC,kBAAD,IACE,EAAE,EAAE,YAAF,oBAAE,YAAY,CAAE,EADpB,EAEE,QAAQ,EAAE,iBAFZ,EAGE,KAAK,EAAE,oBAAoB,GAAG,CAHhC,EAIE,KAAK,EAAE,CAJT,EAKE,gBAAgB,EAAE,KALpB,EAME,eAAe,EAAE,KANnB,EAOE,WAAW,EAAE,eAPf,GAbF,CAJJ,CAhBJ,CAHJ,CAHF;;;;;AAuDE,gBAAC,sBAAD,IACE,SAAS,EAAC,mBADZ,EAEE,oBAAoB,EAAE,oBAFxB;AAIG,EAAA,oBAAoB,IAAI,CAAC,QAAzB,IACC,cAAC,iBAAD,IACE,WAAW,EAAE,oBADf,EAEE,SAAS,EAAE,YAFb;AAIE,gBAAC,aAAD;AACE,gBAAC,SAAD,IACE,WAAW,EAAE,oBADf,EAEE,gBAAgB,EAAE,0BAFpB,EAGE,iBAAiB,EAAE,iBAHrB,GADF,CAJF,CALJ;;;AAkBE,gBAAC,kBAAD,IACE,YAAY,EAAE,YADhB,EAEE,eAAe,EAAE,eAFnB,GAlBF;AAsBG,EAAA,QAAQ,IAAI,cAAC,oBAAD,IAAsB,SAAS,EAAE,YAAjC,GAtBf,CAvDF;;AA+EE,gBAAC,cAAD,OA/EF,CADF;;AAmFD,CArJD,C,cAAM,gB,0NACa,W,EACO,W,EAGP,W,EAGS,W,EAIV,U;AA2IH,gB,CAAf,wB,iLAhMM,W,kIACA,a,oIAIA,sB,6IAoCA,gB","sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* eslint-env browser */\nimport cx from 'classnames';\nimport React, { FC, SyntheticEvent, useEffect, useState } from 'react';\nimport { Sticky, StickyContainer } from 'react-sticky';\nimport { TabContainer } from 'react-bootstrap';\nimport { JsonObject, styled } from '@superset-ui/core';\n\nimport ErrorBoundary from 'src/components/ErrorBoundary';\nimport BuilderComponentPane from 'src/dashboard/components/BuilderComponentPane';\nimport DashboardHeader from 'src/dashboard/containers/DashboardHeader';\nimport IconButton from 'src/dashboard/components/IconButton';\nimport DragDroppable from 'src/dashboard/components/dnd/DragDroppable';\nimport DashboardComponent from 'src/dashboard/containers/DashboardComponent';\nimport ToastPresenter from 'src/messageToasts/containers/ToastPresenter';\nimport WithPopoverMenu from 'src/dashboard/components/menu/WithPopoverMenu';\n\nimport getDirectPathToTabIndex from 'src/dashboard/util/getDirectPathToTabIndex';\nimport { FeatureFlag, isFeatureEnabled } from 'src/featureFlags';\nimport { URL_PARAMS } from 'src/constants';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { getUrlParam } from 'src/utils/urlUtils';\nimport { DashboardLayout, RootState } from 'src/dashboard/types';\nimport { setDirectPathToChild } from 'src/dashboard/actions/dashboardState';\nimport {\n  deleteTopLevelTabs,\n  handleComponentDrop,\n} from 'src/dashboard/actions/dashboardLayout';\nimport {\n  DASHBOARD_GRID_ID,\n  DASHBOARD_ROOT_ID,\n  DASHBOARD_ROOT_DEPTH,\n  DashboardStandaloneMode,\n} from 'src/dashboard/util/constants';\nimport FilterBar from '../nativeFilters/FilterBar/FilterBar';\nimport { StickyVerticalBar } from '../StickyVerticalBar';\nimport { shouldFocusTabs, getRootLevelTabsComponent } from './utils';\nimport { useFilters } from '../nativeFilters/FilterBar/state';\nimport { Filter } from '../nativeFilters/types';\nimport DashboardContainer from './DashboardContainer';\n\nconst TABS_HEIGHT = 47;\nconst HEADER_HEIGHT = 67;\n\ntype DashboardBuilderProps = {};\n\nconst StyledDashboardContent = styled.div<{ dashboardFiltersOpen: boolean }>`\n  display: flex;\n  flex-direction: row;\n  flex-wrap: nowrap;\n  height: auto;\n  flex-grow: 1;\n\n  .grid-container .dashboard-component-tabs {\n    box-shadow: none;\n    padding-left: 0;\n  }\n\n  .grid-container {\n    /* without this, the grid will not get smaller upon toggling the builder panel on */\n    min-width: 0;\n    width: 100%;\n    flex-grow: 1;\n    position: relative;\n    margin: ${({ theme }) => theme.gridUnit * 6}px\n      ${({ theme }) => theme.gridUnit * 8}px\n      ${({ theme }) => theme.gridUnit * 6}px\n      ${({ theme, dashboardFiltersOpen }) => {\n        if (dashboardFiltersOpen) return theme.gridUnit * 8;\n        return 0;\n      }}px;\n  }\n\n  .dashboard-component-chart-holder {\n    // transitionable traits to show filter relevance\n    transition: opacity ${({ theme }) => theme.transitionTiming}s,\n      border-color ${({ theme }) => theme.transitionTiming}s,\n      box-shadow ${({ theme }) => theme.transitionTiming}s;\n    border: 0 solid transparent;\n  }\n`;\n\nconst DashboardBuilder: FC<DashboardBuilderProps> = () => {\n  const dispatch = useDispatch();\n  const dashboardLayout = useSelector<RootState, DashboardLayout>(\n    state => state.dashboardLayout.present,\n  );\n  const editMode = useSelector<RootState, boolean>(\n    state => state.dashboardState.editMode,\n  );\n  const directPathToChild = useSelector<RootState, string[]>(\n    state => state.dashboardState.directPathToChild,\n  );\n\n  const filters = useFilters();\n  const filterValues = Object.values<Filter>(filters);\n\n  const nativeFiltersEnabled = isFeatureEnabled(\n    FeatureFlag.DASHBOARD_NATIVE_FILTERS,\n  );\n\n  const [dashboardFiltersOpen, setDashboardFiltersOpen] = useState(true);\n\n  const toggleDashboardFiltersOpen = (visible?: boolean) => {\n    setDashboardFiltersOpen(visible ?? !dashboardFiltersOpen);\n  };\n\n  const handleChangeTab = ({\n    pathToTabIndex,\n  }: SyntheticEvent<TabContainer, Event> & { pathToTabIndex: string[] }) => {\n    dispatch(setDirectPathToChild(pathToTabIndex));\n  };\n\n  const handleDeleteTopLevelTabs = () => {\n    dispatch(deleteTopLevelTabs());\n\n    const firstTab = getDirectPathToTabIndex(\n      getRootLevelTabsComponent(dashboardLayout),\n      0,\n    );\n    dispatch(setDirectPathToChild(firstTab));\n  };\n\n  const dashboardRoot = dashboardLayout[DASHBOARD_ROOT_ID];\n  const rootChildId = dashboardRoot.children[0];\n  const topLevelTabs =\n    rootChildId !== DASHBOARD_GRID_ID\n      ? dashboardLayout[rootChildId]\n      : undefined;\n\n  const hideDashboardHeader =\n    getUrlParam(URL_PARAMS.standalone, 'number') ===\n    DashboardStandaloneMode.HIDE_NAV_AND_TITLE;\n\n  const barTopOffset =\n    (hideDashboardHeader ? 0 : HEADER_HEIGHT) +\n    (topLevelTabs ? TABS_HEIGHT : 0);\n\n  useEffect(() => {\n    if (\n      filterValues.length === 0 &&\n      dashboardFiltersOpen &&\n      nativeFiltersEnabled\n    ) {\n      toggleDashboardFiltersOpen(false);\n    }\n  }, [filterValues.length]);\n\n  return (\n    <StickyContainer\n      className={cx('dashboard', editMode && 'dashboard--editing')}\n    >\n      <Sticky>\n        {({ style }) => (\n          // @ts-ignore\n          <DragDroppable\n            component={dashboardRoot}\n            parentComponent={null}\n            depth={DASHBOARD_ROOT_DEPTH}\n            index={0}\n            orientation=\"column\"\n            onDrop={() => dispatch(handleComponentDrop)}\n            editMode={editMode}\n            // you cannot drop on/displace tabs if they already exist\n            disableDragdrop={!!topLevelTabs}\n            style={{\n              zIndex: 100,\n              ...style,\n            }}\n          >\n            {({ dropIndicatorProps }: { dropIndicatorProps: JsonObject }) => (\n              <div>\n                {!hideDashboardHeader && <DashboardHeader />}\n                {dropIndicatorProps && <div {...dropIndicatorProps} />}\n                {topLevelTabs && (\n                  <WithPopoverMenu\n                    shouldFocus={shouldFocusTabs}\n                    menuItems={[\n                      <IconButton\n                        className=\"fa fa-level-down\"\n                        label=\"Collapse tab content\"\n                        onClick={handleDeleteTopLevelTabs}\n                      />,\n                    ]}\n                    editMode={editMode}\n                  >\n                    {/*\n                    // @ts-ignore */}\n                    <DashboardComponent\n                      id={topLevelTabs?.id}\n                      parentId={DASHBOARD_ROOT_ID}\n                      depth={DASHBOARD_ROOT_DEPTH + 1}\n                      index={0}\n                      renderTabContent={false}\n                      renderHoverMenu={false}\n                      onChangeTab={handleChangeTab}\n                    />\n                  </WithPopoverMenu>\n                )}\n              </div>\n            )}\n          </DragDroppable>\n        )}\n      </Sticky>\n      <StyledDashboardContent\n        className=\"dashboard-content\"\n        dashboardFiltersOpen={dashboardFiltersOpen}\n      >\n        {nativeFiltersEnabled && !editMode && (\n          <StickyVerticalBar\n            filtersOpen={dashboardFiltersOpen}\n            topOffset={barTopOffset}\n          >\n            <ErrorBoundary>\n              <FilterBar\n                filtersOpen={dashboardFiltersOpen}\n                toggleFiltersBar={toggleDashboardFiltersOpen}\n                directPathToChild={directPathToChild}\n              />\n            </ErrorBoundary>\n          </StickyVerticalBar>\n        )}\n        <DashboardContainer\n          topLevelTabs={topLevelTabs}\n          handleChangeTab={handleChangeTab}\n        />\n        {editMode && <BuilderComponentPane topOffset={barTopOffset} />}\n      </StyledDashboardContent>\n      <ToastPresenter />\n    </StickyContainer>\n  );\n};\n\nexport default DashboardBuilder;\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}