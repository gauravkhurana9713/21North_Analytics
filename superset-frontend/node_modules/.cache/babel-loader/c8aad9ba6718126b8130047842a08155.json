{"ast":null,"code":"(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { Tooltip } from 'src/common/components/Tooltip';\nimport { t, styled, supersetTheme } from '@superset-ui/core';\nimport cx from 'classnames';\nimport Button from 'src/components/Button';\nimport withToasts from 'src/messageToasts/enhancers/withToasts';\nimport Icon from 'src/components/Icon';\nimport CopyToClipboard from 'src/components/CopyToClipboard';\nimport { storeQuery } from 'src/utils/common';\nimport { getClientErrorObject } from 'src/utils/getClientErrorObject';\nimport { FeatureFlag, isFeatureEnabled } from '../../featureFlags';import { jsx as ___EmotionJSX } from \"@emotion/core\";\nconst Styles = styled.div`\n  .btn-disabled {\n    &,\n    &:hover {\n      cursor: default;\n      background-color: ${supersetTheme.colors.grayscale.light2};\n      color: ${supersetTheme.colors.grayscale.base};\n    }\n  }\n  svg {\n    vertical-align: -${supersetTheme.gridUnit * 1.25}px;\n  }\n`;\nfunction ShareSqlLabQuery({ queryEditor, addDangerToast }) {\n  const getCopyUrlForKvStore = callback => {\n    const { dbId, title, schema, autorun, sql } = queryEditor;\n    const sharedQuery = { dbId, title, schema, autorun, sql };\n    return storeQuery(sharedQuery).\n    then(shortUrl => {\n      callback(shortUrl);\n    }).\n    catch(response => {\n      getClientErrorObject(response).then(() => {\n        addDangerToast(t('There was an error with your request'));\n      });\n    });\n  };\n  const getCopyUrlForSavedQuery = callback => {\n    let savedQueryToastContent;\n    if (queryEditor.remoteId) {\n      savedQueryToastContent = `${window.location.origin + window.location.pathname}?savedQueryId=${queryEditor.remoteId}`;\n      callback(savedQueryToastContent);\n    } else\n    {\n      savedQueryToastContent = t('Please save the query to enable sharing');\n      callback(savedQueryToastContent);\n    }\n  };\n  const getCopyUrl = callback => {\n    if (isFeatureEnabled(FeatureFlag.SHARE_QUERIES_VIA_KV_STORE)) {\n      return getCopyUrlForKvStore(callback);\n    }\n    return getCopyUrlForSavedQuery(callback);\n  };\n  const buildButton = () => {\n    const canShare = queryEditor.remoteId ||\n    isFeatureEnabled(FeatureFlag.SHARE_QUERIES_VIA_KV_STORE);\n    return ___EmotionJSX(Styles, null,\n    ___EmotionJSX(Button, { buttonSize: \"small\", className: cx(!canShare && 'btn-disabled') },\n    ___EmotionJSX(Icon, { name: \"link\", color: canShare ?\n      supersetTheme.colors.primary.base :\n      supersetTheme.colors.grayscale.base, width: 20, height: 20 }), ' ',\n    t('Copy link')));\n\n\n  };\n  const canShare = queryEditor.remoteId ||\n  isFeatureEnabled(FeatureFlag.SHARE_QUERIES_VIA_KV_STORE);\n  return ___EmotionJSX(Tooltip, { id: \"copy_link\", placement: \"top\", overlayStyle: {\n      fontSize: supersetTheme.typography.sizes.s,\n      lineHeight: '1.6',\n      maxWidth: '125px' },\n    title: canShare ?\n    t('Copy query link to your clipboard') :\n    t('Save the query to enable this feature') },\n  canShare ? ___EmotionJSX(CopyToClipboard, { getText: getCopyUrl, wrapped: false, copyNode: buildButton() }) : buildButton());\n\n}const _default =\nwithToasts(ShareSqlLabQuery);export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(Styles, \"Styles\", \"/app/superset-frontend/src/SqlLab/components/ShareSqlLabQuery.tsx\");reactHotLoader.register(ShareSqlLabQuery, \"ShareSqlLabQuery\", \"/app/superset-frontend/src/SqlLab/components/ShareSqlLabQuery.tsx\");reactHotLoader.register(_default, \"default\", \"/app/superset-frontend/src/SqlLab/components/ShareSqlLabQuery.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"sources":["/app/superset-frontend/src/SqlLab/components/ShareSqlLabQuery.tsx"],"names":[],"mappings":"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","sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { Tooltip } from 'src/common/components/Tooltip';\nimport { t, styled, supersetTheme } from '@superset-ui/core';\nimport cx from 'classnames';\n\nimport Button from 'src/components/Button';\nimport withToasts from 'src/messageToasts/enhancers/withToasts';\nimport Icon from 'src/components/Icon';\nimport CopyToClipboard from 'src/components/CopyToClipboard';\nimport { storeQuery } from 'src/utils/common';\nimport { getClientErrorObject } from 'src/utils/getClientErrorObject';\nimport { FeatureFlag, isFeatureEnabled } from '../../featureFlags';\n\ninterface ShareSqlLabQueryPropTypes {\n  queryEditor: {\n    dbId: number;\n    title: string;\n    schema: string;\n    autorun: boolean;\n    sql: string;\n    remoteId: number | null;\n  };\n  addDangerToast: (msg: string) => void;\n}\n\nconst Styles = styled.div`\n  .btn-disabled {\n    &,\n    &:hover {\n      cursor: default;\n      background-color: ${supersetTheme.colors.grayscale.light2};\n      color: ${supersetTheme.colors.grayscale.base};\n    }\n  }\n  svg {\n    vertical-align: -${supersetTheme.gridUnit * 1.25}px;\n  }\n`;\n\nfunction ShareSqlLabQuery({\n  queryEditor,\n  addDangerToast,\n}: ShareSqlLabQueryPropTypes) {\n  const getCopyUrlForKvStore = (callback: Function) => {\n    const { dbId, title, schema, autorun, sql } = queryEditor;\n    const sharedQuery = { dbId, title, schema, autorun, sql };\n\n    return storeQuery(sharedQuery)\n      .then(shortUrl => {\n        callback(shortUrl);\n      })\n      .catch(response => {\n        getClientErrorObject(response).then(() => {\n          addDangerToast(t('There was an error with your request'));\n        });\n      });\n  };\n\n  const getCopyUrlForSavedQuery = (callback: Function) => {\n    let savedQueryToastContent;\n\n    if (queryEditor.remoteId) {\n      savedQueryToastContent = `${\n        window.location.origin + window.location.pathname\n      }?savedQueryId=${queryEditor.remoteId}`;\n      callback(savedQueryToastContent);\n    } else {\n      savedQueryToastContent = t('Please save the query to enable sharing');\n      callback(savedQueryToastContent);\n    }\n  };\n  const getCopyUrl = (callback: Function) => {\n    if (isFeatureEnabled(FeatureFlag.SHARE_QUERIES_VIA_KV_STORE)) {\n      return getCopyUrlForKvStore(callback);\n    }\n    return getCopyUrlForSavedQuery(callback);\n  };\n\n  const buildButton = () => {\n    const canShare =\n      queryEditor.remoteId ||\n      isFeatureEnabled(FeatureFlag.SHARE_QUERIES_VIA_KV_STORE);\n    return (\n      <Styles>\n        <Button buttonSize=\"small\" className={cx(!canShare && 'btn-disabled')}>\n          <Icon\n            name=\"link\"\n            color={\n              canShare\n                ? supersetTheme.colors.primary.base\n                : supersetTheme.colors.grayscale.base\n            }\n            width={20}\n            height={20}\n          />{' '}\n          {t('Copy link')}\n        </Button>\n      </Styles>\n    );\n  };\n\n  const canShare =\n    queryEditor.remoteId ||\n    isFeatureEnabled(FeatureFlag.SHARE_QUERIES_VIA_KV_STORE);\n\n  return (\n    <Tooltip\n      id=\"copy_link\"\n      placement=\"top\"\n      overlayStyle={{\n        fontSize: supersetTheme.typography.sizes.s,\n        lineHeight: '1.6',\n        maxWidth: '125px',\n      }}\n      title={\n        canShare\n          ? t('Copy query link to your clipboard')\n          : t('Save the query to enable this feature')\n      }\n    >\n      {canShare ? (\n        <CopyToClipboard\n          getText={getCopyUrl}\n          wrapped={false}\n          copyNode={buildButton()}\n        />\n      ) : (\n        buildButton()\n      )}\n    </Tooltip>\n  );\n}\n\nexport default withToasts(ShareSqlLabQuery);\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}